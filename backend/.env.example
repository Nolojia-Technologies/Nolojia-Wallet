# Database Configuration
DATABASE_HOST=localhost
DATABASE_PORT=5432
DATABASE_NAME=nolojia_wallet
DATABASE_USERNAME=postgres
DATABASE_PASSWORD=your_secure_password
DATABASE_SSL=false

# JWT Configuration
JWT_SECRET=your_very_secure_jwt_secret_key_at_least_32_characters_long
JWT_EXPIRES_IN=24h
JWT_REFRESH_EXPIRES_IN=7d

# Application Configuration
NODE_ENV=development
PORT=3000
APP_URL=http://localhost:3000
FRONTEND_URL=http://localhost:5173

# M-Pesa Configuration (Safaricom Daraja API)
MPESA_ENVIRONMENT=sandbox
MPESA_CONSUMER_KEY=your_mpesa_consumer_key
MPESA_CONSUMER_SECRET=your_mpesa_consumer_secret
MPESA_PASSKEY=your_mpesa_passkey
MPESA_SHORTCODE=174379
MPESA_CALLBACK_URL=https://your-domain.com/api/topup/webhook
MPESA_TIMEOUT_URL=https://your-domain.com/api/topup/timeout

# Bank Integration Configuration
BANK_WEBHOOK_SECRET=your_bank_webhook_secret_key
BANK_API_KEY=your_bank_api_key
BANK_API_SECRET=your_bank_api_secret

# Security Configuration
ENCRYPTION_KEY=your_32_character_encryption_key
WEBHOOK_SECRET=your_webhook_verification_secret
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=100

# Audit & Monitoring
LOG_LEVEL=info
ENABLE_AUDIT_LOGGING=true
SENTRY_DSN=your_sentry_dsn_for_error_tracking

# Email Configuration (for notifications and verification)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=your_email@gmail.com
SMTP_PASS=your_app_specific_password
SMTP_FROM=Nolojia Wallet <noreply@nolojia.com>

# Alternative Email Providers
# For SendGrid:
# SMTP_HOST=smtp.sendgrid.net
# SMTP_PORT=587
# SMTP_USER=apikey
# SMTP_PASS=your_sendgrid_api_key

# For Mailgun:
# SMTP_HOST=smtp.mailgun.org
# SMTP_PORT=587
# SMTP_USER=your_mailgun_username
# SMTP_PASS=your_mailgun_password

# SMS Configuration (for notifications)
SMS_API_KEY=your_sms_api_key
SMS_SENDER_ID=NOLOJIA

# Africa's Talking SMS API Configuration
AFRICASTALKING_BASE_URL=https://api.africastalking.com/version1
AFRICASTALKING_USERNAME=sandbox
AFRICASTALKING_API_KEY=atsk_16a72e6f7b749170623c1f284709a339b2c75f2a08c0a8e3138d5cd953c399976463bc45
AFRICASTALKING_SENDER_ID=NOLOJIA

# Note: If you don't have a custom username, use 'sandbox' for testing
# Once you get your custom username from Africa's Talking, replace 'sandbox' above

# Alternative endpoints (sandbox/production)
# AFRICASTALKING_BASE_URL=https://api.sandbox.africastalking.com/version1  # For sandbox testing
APP_NAME=Nolojia Wallet

# OTP Configuration
OTP_SECRET=your-otp-secret-key-for-hashing
MINIMUM_BALANCE_THRESHOLD=100

# Redis Configuration (for session management and caching)
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=your_redis_password

# File Upload Configuration
MAX_FILE_SIZE=5242880
UPLOAD_PATH=./uploads

# API Rate Limiting
FINANCIAL_ENDPOINT_RATE_LIMIT=3
GENERAL_ENDPOINT_RATE_LIMIT=100
WEBHOOK_ENDPOINT_RATE_LIMIT=1000

# Transaction Limits (in KSH)
MAX_DAILY_TOPUP=500000
MAX_SINGLE_TOPUP=100000
MIN_TOPUP_AMOUNT=50

# Fraud Detection
ENABLE_FRAUD_DETECTION=true
SUSPICIOUS_VELOCITY_THRESHOLD=5
SUSPICIOUS_AMOUNT_THRESHOLD=100000

# Development Settings
ENABLE_SWAGGER=true
ENABLE_CORS=true
CORS_ORIGIN=http://localhost:5173

# Production Security Headers
HELMET_ENABLED=true
CSRF_PROTECTION=true

# Enhanced Security Configuration
JWT_REFRESH_SECRET=your_jwt_refresh_secret_different_from_access_token
HMAC_SECRET=your_hmac_secret_for_data_integrity_verification
SESSION_SECRET=your_session_secret_key_for_encryption
BACKUP_ENCRYPTION_KEY=your_backup_encryption_key

# Two-Factor Authentication
TWO_FACTOR_ISSUER=Nolojia Wallet
TWO_FACTOR_WINDOW=2

# Security Timeouts & Limits (in milliseconds)
LOGIN_LOCKOUT_DURATION=1800000
MAX_LOGIN_ATTEMPTS=5
SESSION_TIMEOUT=3600000
REFRESH_TOKEN_EXPIRY=604800000
MAX_SESSIONS_PER_USER=5

# Rate Limiting Configuration
AUTH_RATE_LIMIT_WINDOW=900000
AUTH_RATE_LIMIT_MAX=5
TRANSACTION_RATE_LIMIT_WINDOW=60000
TRANSACTION_RATE_LIMIT_MAX=10
PUBLIC_RATE_LIMIT_WINDOW=900000
PUBLIC_RATE_LIMIT_MAX=300

# IP Security
TRUSTED_IPS=127.0.0.1,::1
ENABLE_IP_WHITELIST=false
ENABLE_GEOBLOCKING=false
BLOCKED_COUNTRIES=

# Request Security
MAX_REQUEST_SIZE=10485760
ENABLE_REQUEST_VALIDATION=true
ENABLE_SQL_INJECTION_PROTECTION=true
ENABLE_XSS_PROTECTION=true

# Monitoring & Logging
ENABLE_SECURITY_LOGGING=true
ENABLE_FAILED_LOGIN_LOGGING=true
SECURITY_LOG_LEVEL=warn
LOG_SENSITIVE_DATA=false

# PIN & Password Security
MIN_PASSWORD_LENGTH=8
REQUIRE_SPECIAL_CHARS=true
REQUIRE_NUMBERS=true
REQUIRE_UPPERCASE=true
REQUIRE_LOWERCASE=true
PIN_LENGTH=6

# Transaction Security
REQUIRE_PIN_FOR_TRANSACTIONS=true
ENABLE_TRANSACTION_SIGNING=true
TRANSACTION_TIMEOUT_MS=300000
ENABLE_BIOMETRIC_AUTH=false

# API Key Security
API_KEY_PREFIX=nw_
API_KEY_LENGTH=32
ENABLE_API_KEY_ROTATION=true

# Backup & Recovery
ENABLE_AUTOMATED_BACKUPS=true
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=30

# Payment Provider URLs
MPESA_BASE_URL_SANDBOX=https://sandbox.safaricom.co.ke
MPESA_BASE_URL_PRODUCTION=https://api.safaricom.co.ke